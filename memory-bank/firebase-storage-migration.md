# Firebase Storage Migration

## Overview
This document outlines the migration from the planned Backblaze B2 implementation to Firebase Storage for image uploads in the Gorlea Snaps application.

## Reason for Migration
The initial attempt to implement Backblaze B2 encountered issues with the API route structure. Since the project is using Vite with React (not Next.js), the `/api/get-upload-url` endpoint was not accessible. Firebase Storage was chosen as the alternative since:

1. Firebase is already integrated into the project
2. It provides a simpler client-side upload solution
3. It eliminates the need for a separate server-side component

## Migration Steps Completed

1. Removed the Next.js API route:
   - Deleted `src/pages/api/get-upload-url.ts` which was incompatible with Vite

2. Updated the upload helper:
   - Modified `src/lib/uploadToB2.ts` to use Firebase Storage instead of Backblaze B2
   - Kept the function name `uploadToB2` to minimize changes across the codebase

3. Updated front-end integration:
   - Modified `src/services/storyGenerator.ts` to reference Firebase Storage
   - Updated error handling in both the story generator and `MainPage.tsx`

4. Updated environment variables:
   - Removed Backblaze B2 configuration from `.env.local`
   - Added a comment indicating Firebase Storage is used for uploads

5. Updated documentation:
   - Modified README.md to reflect the use of Firebase Storage
   - Created this migration document

## Implementation Details

### Upload Flow
1. The front-end creates a unique filename with timestamp and user ID
2. The file is uploaded directly to Firebase Storage using the Firebase SDK
3. After successful upload, the download URL is retrieved and used in the application

### File Structure
- Files are stored in user-specific folders: `stories/{uid}/{timestamp}_{filename}`
- Download URLs are automatically generated by Firebase

## Advantages of Firebase Storage

1. **Simplified Implementation**: No need for server-side components or API routes
2. **Integrated Security**: Uses Firebase Authentication for access control
3. **Automatic CDN**: Files are served through Google's global CDN
4. **Scalability**: Handles large files and high traffic without additional configuration
5. **Consistent Ecosystem**: Aligns with the project's use of Firebase Auth and Firestore

## Future Considerations

1. **Storage Rules**: Implement proper Firebase Storage security rules to restrict access
2. **Image Optimization**: Consider adding client-side image compression before upload
3. **Cleanup**: Implement a function to remove unused images
4. **Monitoring**: Set up usage alerts to monitor storage consumption
